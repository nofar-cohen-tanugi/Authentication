import*as e from"react";import{PrimeReactContext as r}from"primereact/api";import{useMountEffect as n,useUnmountEffect as t}from"primereact/hooks";import{classNames as l,mergeProps as o,DomHandler as a}from"primereact/utils";import{ComponentBase as c,useHandleStyle as s}from"primereact/componentbase";var u=c.extend({defaultProps:{__TYPE:"ScrollPanel",id:null,style:null,className:null,children:void 0},css:{classes:{root:function(e){return l("p-scrollpanel p-component",e.props.className)},wrapper:"p-scrollpanel-wrapper",content:"p-scrollpanel-content",barx:"p-scrollpanel-bar p-scrollpanel-bar-x",bary:"p-scrollpanel-bar p-scrollpanel-bar-y"},styles:"\n        @layer primereact {\n            .p-scrollpanel-wrapper {\n                overflow: hidden;\n                width: 100%;\n                height: 100%;\n                position: relative;\n                z-index: 1;\n                float: left;\n            }\n            \n            .p-scrollpanel-content {\n                height: calc(100% + 18px);\n                width: calc(100% + 18px);\n                padding: 0 18px 18px 0;\n                position: relative;\n                overflow: hidden;\n                box-sizing: border-box;\n            }\n            \n            .p-scrollpanel-bar {\n                position: relative;\n                background: #c1c1c1;\n                border-radius: 3px;\n                z-index: 2;\n                cursor: pointer;\n                opacity: 0;\n                transition: opacity 0.25s linear;\n            }\n            \n            .p-scrollpanel-bar-y {\n                width: 9px;\n                top: 0;\n            }\n            \n            .p-scrollpanel-bar-x {\n                height: 9px;\n                bottom: 0;\n            }\n            \n            .p-scrollpanel-hidden {\n                visibility: hidden;\n            }\n            \n            .p-scrollpanel:hover .p-scrollpanel-bar,\n            .p-scrollpanel:active .p-scrollpanel-bar {\n                opacity: 1;\n            }\n            \n            .p-scrollpanel-grabbed {\n                user-select: none;\n            }\n        }\n        "}}),i=e.forwardRef((function(l,c){var i=e.useContext(r),p=u.getProps(l,i),d=u.setMetaData({props:p}),m=d.ptm,f=d.cx;s(u.css.styles,d.isUnstyled,{name:"scrollpanel"});var h=e.useRef(null),g=e.useRef(null),b=e.useRef(null),v=e.useRef(null),x=e.useRef(!1),w=e.useRef(!1),y=e.useRef(null),E=e.useRef(null),C=e.useRef(null),R=e.useRef(null),L=e.useRef(null),H=e.useRef(!1),F=function(){var e=g.current.scrollWidth,r=-1*(h.current.clientHeight-b.current.clientHeight);C.current=g.current.clientWidth/e;var n=g.current.scrollHeight,t=-1*(h.current.clientWidth-v.current.clientWidth);R.current=g.current.clientHeight/n,L.current=window.requestAnimationFrame((function(){C.current>=1?a.addClass(b.current,"p-scrollpanel-hidden"):(a.removeClass(b.current,"p-scrollpanel-hidden"),b.current.style.cssText="width:"+Math.max(100*C.current,10)+"%; left:"+g.current.scrollLeft/e*100+"%;bottom:"+r+"px;"),R.current>=1?a.addClass(v.current,"p-scrollpanel-hidden"):(a.removeClass(v.current,"p-scrollpanel-hidden"),v.current.style.cssText="height:"+Math.max(100*R.current,10)+"%; top: calc("+g.current.scrollTop/n*100+"% - "+b.current.clientHeight+"px);right:"+t+"px;")}))},N=function(e){x.current?T(e):(w.current||T(e),M(e))},T=function(e){var r=e.pageX-y.current;y.current=e.pageX,L.current=window.requestAnimationFrame((function(){g.current.scrollLeft+=r/C.current}))},M=function(e){var r=e.pageY-E.current;E.current=e.pageY,L.current=window.requestAnimationFrame((function(){g.current.scrollTop+=r/R.current}))},P=function e(r){a.removeClass(v.current,"p-scrollpanel-grabbed"),a.removeClass(b.current,"p-scrollpanel-grabbed"),a.removeClass(document.body,"p-scrollpanel-grabbed"),document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",e),x.current=!1,w.current=!1},W=function(){F()};n((function(){var e,r,n;F(),window.addEventListener("resize",F),e=getComputedStyle(h.current),r=getComputedStyle(b.current),n=a.getHeight(h.current)-parseInt(r.height,10),"none"!==e["max-height"]&&0===n&&(h.current.style.height=g.current.offsetHeight+parseInt(r.height,10)>parseInt(e["max-height"],10)?e["max-height"]:g.current.offsetHeight+parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)+parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth)+"px"),H.current=!0})),t((function(){H.current&&window.removeEventListener("resize",F),L.current&&window.cancelAnimationFrame(L.current)})),e.useImperativeHandle(c,(function(){return{props:p,refresh:W,getElement:function(){return h.current},getContent:function(){return g.current},getXBar:function(){return b.current},getYBar:function(){return v.current}}}));var z=o({id:p.id,ref:h,style:p.style,className:f("root")},u.getOtherProps(p),m("root")),D=o({className:f("wrapper")},m("wrapper")),S=o({className:f("content"),ref:g,onScroll:F,onMouseEnter:F},m("content")),Y=o({ref:b,className:f("barx"),onMouseDown:function(e){x.current=!0,y.current=e.pageX,a.addClass(b.current,"p-scrollpanel-grabbed"),a.addClass(document.body,"p-scrollpanel-grabbed"),document.addEventListener("mousemove",N),document.addEventListener("mouseup",P),e.preventDefault()}},m("barx")),A=o({ref:v,className:f("bary"),onMouseDown:function(e){w.current=!0,E.current=e.pageY,a.addClass(v.current,"p-scrollpanel-grabbed"),a.addClass(document.body,"p-scrollpanel-grabbed"),document.addEventListener("mousemove",N),document.addEventListener("mouseup",P),e.preventDefault()}},m("bary"));return e.createElement("div",z,e.createElement("div",D,e.createElement("div",S,p.children)),e.createElement("div",Y),e.createElement("div",A))}));i.displayName="ScrollPanel";export{i as ScrollPanel};
